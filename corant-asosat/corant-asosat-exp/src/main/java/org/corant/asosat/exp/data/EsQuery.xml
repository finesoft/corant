<?xml version="1.0" encoding="UTF-8"?>
<query-mappings
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<common-segment>
		This is common segment!
	</common-segment>

	<query name="test.searchAll" result-class="java.util.Map"
		cache="true" cache-resultset-metadata="false">
		<script>
			<![CDATA[
			 {
			 	"query":{
				  	<#if keyword??>
				  		"term": {
						      "instant": "${keyword}"
						    }
				  	<#else>
				    	"match_all": {}
				    </#if>
				}
			}
				
			]]>
		</script>
	</query>
	
	
	<query name="test-pc.parent" result-class="java.util.Map"
		cache="true" cache-resultset-metadata="false">
		<script>
			<![CDATA[
				{
				  "query": {
				    "bool": {
				      "must": [
				        {
				          "term": {
				            "esId": "${pid}"
				          }
				        },
				        {
				          "term": {
				            "relation": "parent"
				          }
				        }
				      ]
				    }
				  }
				}
			]]>
		</script>
		<fetch-query reference-query="test-pc.child"
			inject-property-name="children">
			<parameter name="parentId" source="R" source-name="esId" />
		</fetch-query>
	</query>
	
	<query name="test-pc.child" result-class="java.util.Map"
		cache="true" cache-resultset-metadata="false">
		<script>
			<![CDATA[
				{
				  "query": {
				    "parent_id": {
				      "type": "child",
				      "id": "${parentId}"
				    }
				  }
				}
			]]>
		</script>
	</query>
	
</query-mappings>